(()=>{"use strict";function e(e){e.classList.add("modal_display"),document.addEventListener("keydown",r)}function t(e){e.classList.remove("modal_display"),document.removeEventListener("keydown",r)}function r(e){const r=document.querySelector(".modal_display");"Escape"===e.key&&t(r)}function i(e){t(e.target.closest(".modal"))}const s=document.querySelector(".modal_type_preview"),a=s.querySelector(".modal__caption"),n=s.querySelector(".modal__image"),l=class{constructor(e,t){this._templateSel=t,this._name=e.name,this._link=e.link}_getTemplate(){return document.querySelector(this._templateSel).content.querySelector(".card").cloneNode(!0)}_handleLike(e){e.target.classList.toggle("card__like_active")}_handleTrash(e){e.target.closest(".card").remove()}_handlePreview(t){const r=t.target,i=r.closest(".card").querySelector(".card__title");n.src=r.src,n.alt=r.alt,a.textContent=i.textContent,e(s)}_setEventListeners(){this._cardEl.querySelector(".card__like").addEventListener("click",this._handleLike),this._cardEl.querySelector(".card__trash").addEventListener("click",this._handleTrash),this._cardImgEl.addEventListener("click",this._handlePreview)}createCard(){return this._cardEl=this._getTemplate(),this._cardEl.querySelector(".card__title").textContent=this._name,this._cardImgEl=this._cardEl.querySelector(".card__image"),this._cardImgEl.src=this._link,this._cardImgEl.alt=`Image of ${this._name}`,this._setEventListeners(this._cardEl),this._cardEl}},o={formSel:".modal__form",inputSel:".modal__input",submitBtnSel:".modal__save",inactiveBtnClass:"modal__save_inactive",inputErrClass:"modal__input_type_error",errorClass:"modal__input-error"},c=class{constructor(e=o,t){this._inputSel=e.inputSel,this._submitBtnSel=e.submitBtnSel,this._inactiveBtnClass=e.inactiveBtnClass,this._inputErrClass=e.inputErrClass,this._errorClass=e.errorClass,this._formEl=t}_showInputErr(e,t){this._errorEl=this._formEl.querySelector(`.${this._errorClass}_${e.id}`),e.classList.add(this._inputErrClass),this._errorEl.textContent=t,this._errorEl.classList.add(`${this._errorClass}_active`)}_hideInputErr(e){this._errorEl=this._formEl.querySelector(`.${this._errorClass}_${e.id}`),e.classList.remove(this._inputErrClass),this._errorEl.textContent="",this._errorEl.classList.remove(`${this._errorClass}_active`)}_checkInputValidity(e){e.validity.valid?this._hideInputErr(e):this._showInputErr(e,e.validationMessage)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleBtnState(e,t){this._hasInvalidInput(e)?(t.classList.add(this._inactiveBtnClass),t.setAttribute("disabled","")):(t.classList.remove(this._inactiveBtnClass),t.removeAttribute("disabled"))}_setEventListeners(){this._inputList=Array.from(this._formEl.querySelectorAll(this._inputSel)),this._buttonEl=this._formEl.querySelector(this._submitBtnSel),this._toggleBtnState(this._inputList,this._buttonEl),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleBtnState(this._inputList,this._buttonEl)}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputList.forEach((e=>{this._hideInputErr(e)}))}},d=document.querySelectorAll(".modal"),_=document.querySelector(".modal_type_card"),u=document.querySelector(".modal_type_profile"),m=document.querySelectorAll(".modal__close-btn"),h=document.querySelector(".profile"),p=h.querySelector(".profile__edit-btn"),v=h.querySelector(".profile__add-btn"),E=u.querySelector(".modal__form_type_profile"),y=E.querySelector("input[name='name']"),S=E.querySelector("input[name='career']"),L=h.querySelector(".profile__name"),f=h.querySelector(".profile__career"),g=_.querySelector(".modal__form_type_card"),C=_.querySelector("input[name='place']"),q=_.querySelector("input[name='image']"),k=document.querySelector(".cards");function b(e){k.prepend(e)}m.forEach((e=>{e.addEventListener("click",i)})),d.forEach((e=>{e.addEventListener("click",(r=>{r.target.classList.contains("modal")&&t(e)})),document.addEventListener("keydown",r)}));const w={formSel:".modal__form",inputSel:".modal__input",submitBtnSel:".modal__save",inactiveBtnClass:"modal__save_inactive",inputErrClass:"modal__input_type_error",errorClass:"modal__input-error"},B=new c(w,_);B.enableValidation();const I=new c(w,u);I.enableValidation(),E.addEventListener("submit",(function(e){e.preventDefault(),L.textContent=y.value,f.textContent=S.value,t(u)})),p.addEventListener("click",(function(){y.value=L.textContent,S.value=f.textContent,I.resetValidation(),e(u)})),v.addEventListener("click",(function(){g.reset(),B.resetValidation(),e(_)})),g.addEventListener("submit",(function(e){e.preventDefault();const r={name:C.value,link:q.value};b(new l(r,"#card").createCard()),t(_)})),[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}].reverse().forEach((e=>{b(new l(e,"#card").createCard())}))})();