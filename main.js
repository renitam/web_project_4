!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._popupElement=document.querySelector(e),this._handleEsc=this._handleEsc.bind(this),this._handleClose=this._handleClose.bind(this),this.open=this.open.bind(this)}var n,r;return n=t,(r=[{key:"_handleEsc",value:function(e){"Escape"===e.key&&this.close()}},{key:"_handleClose",value:function(e){(e.target.classList.contains("modal")||e.target.classList.contains("modal__close-btn"))&&this.close()}},{key:"_setEventListeners",value:function(){this._popupElement.addEventListener("click",this._handleClose),document.addEventListener("keyup",this._handleEsc)}},{key:"_removeEventListeners",value:function(){this._popupElement.removeEventListener("click",this._handleClose),document.removeEventListener("keyup",this._handleEsc)}},{key:"open",value:function(){this._popupElement.classList.add("modal_display"),this._setEventListeners()}},{key:"close",value:function(){this._popupElement.classList.remove("modal_display"),this._removeEventListeners()}}])&&e(n.prototype,r),t}();function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=a(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},i.apply(this,arguments)}function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(p,e);var t,n,a,u,f=(a=p,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(a);if(u){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(){return r(this,p),f.apply(this,arguments)}return t=p,(n=[{key:"open",value:function(e,t){this._popupElement.querySelector(".modal__caption").textContent=t;var n=this._popupElement.querySelector(".modal__image");n.src=e,n.alt="Image of ".concat(t),i(c(p.prototype),"open",this).call(this)}}])&&o(t.prototype,n),p}(t),f=u;function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._templateSel=n,this._name=t.name,this._link=t.link,this._handlePreview=this._handlePreview.bind(this)}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSel).content.querySelector(".card").cloneNode(!0)}},{key:"_handleLike",value:function(e){e.target.classList.toggle("card__like_active")}},{key:"_handleTrash",value:function(e){e.target.closest(".card").remove()}},{key:"_handlePreview",value:function(){this._preview=new f(".modal_type_preview"),this._preview.open(this._link,this._name)}},{key:"_setEventListeners",value:function(){this._cardEl.querySelector(".card__like").addEventListener("click",this._handleLike),this._cardEl.querySelector(".card__trash").addEventListener("click",this._handleTrash),this._cardImgEl.addEventListener("click",this._handlePreview)}},{key:"createCard",value:function(){return this._cardEl=this._getTemplate(),this._cardTitleEl=this._cardEl.querySelector(".card__title"),this._cardTitleEl.textContent=this._name,this._cardImgEl=this._cardEl.querySelector(".card__image"),this._cardImgEl.src=this._link,this._cardImgEl.alt="Image of ".concat(this._name),this._setEventListeners(this._cardEl),this._cardEl}}])&&p(t.prototype,n),e}();function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y={formSel:".modal__form",inputSel:".modal__input",submitBtnSel:".modal__save",inactiveBtnClass:"modal__save_inactive",inputErrClass:"modal__input_type_error",errorClass:"modal__input-error"},v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,n=arguments.length>1?arguments[1]:void 0;h(this,e),this._inputSel=t.inputSel,this._submitBtnSel=t.submitBtnSel,this._inactiveBtnClass=t.inactiveBtnClass,this._inputErrClass=t.inputErrClass,this._errorClass=t.errorClass,this._formEl=n}var t,n;return t=e,(n=[{key:"_showInputErr",value:function(e,t){this._errorEl=this._formEl.querySelector(".".concat(this._errorClass,"_").concat(e.id)),e.classList.add(this._inputErrClass),this._errorEl.textContent=t,this._errorEl.classList.add("".concat(this._errorClass,"_active"))}},{key:"_hideInputErr",value:function(e){this._errorEl=this._formEl.querySelector(".".concat(this._errorClass,"_").concat(e.id)),e.classList.remove(this._inputErrClass),this._errorEl.textContent="",this._errorEl.classList.remove("".concat(this._errorClass,"_active"))}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputErr(e):this._showInputErr(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"_toggleBtnState",value:function(e,t){this._hasInvalidInput(e)?(t.classList.add(this._inactiveBtnClass),t.setAttribute("disabled","")):(t.classList.remove(this._inactiveBtnClass),t.removeAttribute("disabled"))}},{key:"_setEventListeners",value:function(){var e=this;this._inputList=Array.from(this._formEl.querySelectorAll(this._inputSel)),this._buttonEl=this._formEl.querySelector(this._submitBtnSel),this._toggleBtnState(this._inputList,this._buttonEl),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleBtnState(e._inputList,e._buttonEl)}))}))}},{key:"enableValidation",value:function(){this._formEl.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}},{key:"resetValidation",value:function(){var e=this;this._inputList.forEach((function(t){e._hideInputErr(t)}))}}])&&d(t.prototype,n),e}(),m=v;function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=k(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g.apply(this,arguments)}function k(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function S(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(r);if(o){var n=L(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S(this,e)});function a(e,t){var n,r=e.handleSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t))._handleSubmit=r,n.inputList=n._popupElement.querySelectorAll(".modal__input"),n}return t=a,(n=[{key:"getInputValues",value:function(){var e=this;return this._formValues={},this.inputList.forEach((function(t){e._formValues[t.name]=t.value})),this._formValues}},{key:"_setEventListeners",value:function(){var e=this;g(L(a.prototype),"_setEventListeners",this).call(this),this._popupElement.addEventListener("submit",(function(t){e._handleSubmit(t),e.close()}))}}])&&E(t.prototype,n),a}(t);function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(t,n){var r=t.data,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;this._items.forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&O(t.prototype,n),e}();function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=function(){function e(t){var n=t.nameSelector,r=t.careerSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameElement=document.querySelector(n),this._careerElement=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._nameElement.textContent,career:this._careerElement.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.career;this._nameElement.textContent=t,this._careerElement.textContent=n}}])&&I(t.prototype,n),e}(),q=document.querySelector(".profile__edit-btn"),B=document.querySelector(".profile__add-btn"),x=document.querySelector(".modal__form_type_profile"),R=document.querySelector(".modal__form_type_card"),T={formSel:".modal__form",inputSel:".modal__input",submitBtnSel:".modal__save",inactiveBtnClass:"modal__save_inactive",inputErrClass:"modal__input_type_error",errorClass:"modal__input-error"},V=function(e){var t=new _(e,"#card").createCard();D.addItem(t)},D=new j({data:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}].reverse(),renderer:V},".cards");D.renderItems();var A=new P({nameSelector:".profile__name",careerSelector:".profile__career"}),U=new C({handleSubmit:function(e){e.preventDefault(),A.setUserInfo(U.getInputValues())},handleOpen:function(){}},".modal_type_profile"),M=new m(T,x);M.enableValidation(),q.addEventListener("click",(function(){var e=A.getUserInfo(),t=e.name,n=e.career;U.inputList[0].value=t,U.inputList[1].value=n,M.resetValidation(),U.open()}));var N=new C({handleSubmit:function(e){e.preventDefault();var t=N.getInputValues();V(t)}},".modal_type_card"),Y=new m(T,R);Y.enableValidation(),B.addEventListener("click",(function(){R.reset(),Y.resetValidation(),N.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8veHhlbmcucHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8veHhlbmcucHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly94eGVuZy5wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3h4ZW5nLnByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8veHhlbmcucHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly94eGVuZy5wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly94eGVuZy5wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8veHhlbmcucHJhY3RpY3VtLy4vc3JjL3V0aWxzL2luaXRpYWxDYXJkcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzYyA9IHRoaXMuX2hhbmRsZUVzYy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZUNsb3NlID0gdGhpcy5faGFuZGxlQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9wZW4gPSB0aGlzLm9wZW4uYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2MoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBfaGFuZGxlQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKFxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2UtYnRuXCIpXG4gICAgICApIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDbG9zZSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzYyk7XG4gIH1cblxuICBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDbG9zZSk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzYyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfZGlzcGxheVwiKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9kaXNwbGF5XCIpO1xuICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXA7IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuXG4gIG9wZW4obGluaywgbmFtZSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2NhcHRpb24nKS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgY29uc3QgcHJldmlld0ltZyA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2ltYWdlJyk7XG4gICAgcHJldmlld0ltZy5zcmMgPSBsaW5rO1xuICAgIHByZXZpZXdJbWcuYWx0ID0gYEltYWdlIG9mICR7bmFtZX1gO1xuXG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlOyIsImltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi9Qb3B1cFdpdGhJbWFnZVwiO1xuXG4vLyBDbGFzc2VzXG5cbmNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihkYXRhLCB0ZW1wbGF0ZVNlbCkge1xuICAgIHRoaXMuX3RlbXBsYXRlU2VsID0gdGVtcGxhdGVTZWw7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2hhbmRsZVByZXZpZXcgPSB0aGlzLl9oYW5kbGVQcmV2aWV3LmJpbmQodGhpcyk7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRUZW1wbGF0ZTtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlKGV2dCkge1xuICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2VfYWN0aXZlXCIpO1xuICB9XG5cbiAgX2hhbmRsZVRyYXNoKGV2dCkge1xuICAgIGV2dC50YXJnZXQuY2xvc2VzdChcIi5jYXJkXCIpLnJlbW92ZSgpO1xuICB9XG5cbiAgX2hhbmRsZVByZXZpZXcoKSB7XG4gICAgLy8gUHVsbCBwcmV2aWV3IG1vZGFsIGVsZW1lbnRzIGZyb20gdXRpbHMuanMgY29uc3RhbnQgZXhwb3J0c1xuICAgIHRoaXMuX3ByZXZpZXcgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIubW9kYWxfdHlwZV9wcmV2aWV3XCIpO1xuICAgIHRoaXMuX3ByZXZpZXcub3Blbih0aGlzLl9saW5rLCB0aGlzLl9uYW1lKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBNYWtlIGNhcmQgbGlrZSBidXR0b25zIGNsaWNrYWJsZSAmIHNhdmUgbGlrZVxuICAgIHRoaXMuX2NhcmRFbC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZSk7XG5cbiAgICAvLyBNYWtlIHRyYXNoIGNhbnMgY2xpY2thYmxlIGFuZCByZW1vdmUgY2FyZFxuICAgIHRoaXMuX2NhcmRFbC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZVRyYXNoKTtcblxuICAgIC8vIE1ha2UgaW1hZ2VzIGNsaWNrYWJsZSBhbmQgdmlldyBpbWFnZSBwcmV2aWV3XG4gICAgdGhpcy5fY2FyZEltZ0VsXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZVByZXZpZXcpO1xuICB9XG5cbiAgY3JlYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWwgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuXG4gICAgLy8gU2V0IHRpdGxlIHRvIG5hbWUgaW5wdXRcbiAgICB0aGlzLl9jYXJkVGl0bGVFbCA9IHRoaXMuX2NhcmRFbC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIC8vIFNldCBpbWFnZSB0byBsaW5rIGlucHV0XG4gICAgdGhpcy5fY2FyZEltZ0VsID0gdGhpcy5fY2FyZEVsLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZEltZ0VsLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltZ0VsLmFsdCA9IGBJbWFnZSBvZiAke3RoaXMuX25hbWV9YDtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKHRoaXMuX2NhcmRFbCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsO1xuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDsiLCJjb25zdCBmb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbDogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWw6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdG5TZWw6IFwiLm1vZGFsX19zYXZlXCIsXG4gIGluYWN0aXZlQnRuQ2xhc3M6IFwibW9kYWxfX3NhdmVfaW5hY3RpdmVcIixcbiAgaW5wdXRFcnJDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvclwiXG59XG5cbmNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcgPSBmb3JtVmFsaWRhdGlvbkNvbmZpZywgZm9ybUVsKSB7XG4gICAgdGhpcy5faW5wdXRTZWwgPSBjb25maWcuaW5wdXRTZWw7XG4gICAgdGhpcy5fc3VibWl0QnRuU2VsID0gY29uZmlnLnN1Ym1pdEJ0blNlbDtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ0bkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnRuQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJDbGFzcyA9IGNvbmZpZy5pbnB1dEVyckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2Zvcm1FbCA9IGZvcm1FbDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnIgKGlucHV0RWwsIGVycm9yTXNnKSB7XG4gICAgdGhpcy5fZXJyb3JFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLl9lcnJvckNsYXNzfV8ke2lucHV0RWwuaWR9YCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcbiAgICB0aGlzLl9lcnJvckVsLmNsYXNzTGlzdC5hZGQoYCR7dGhpcy5fZXJyb3JDbGFzc31fYWN0aXZlYCk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyIChpbnB1dEVsKSB7XG4gICAgdGhpcy5fZXJyb3JFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLl9lcnJvckNsYXNzfV8ke2lucHV0RWwuaWR9YCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHRoaXMuX2Vycm9yRWwuY2xhc3NMaXN0LnJlbW92ZShgJHt0aGlzLl9lcnJvckNsYXNzfV9hY3RpdmVgKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgKGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycihpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyKGlucHV0RWwpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQgKGlucHV0TGlzdCkge1xuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkO1xuICAgIH0pO1xuICB9XG5cbiAgLyogc2V0IGFuZCByZW1vdmUgYXR0cmlidXRlIGNhbGxzIGJyZWFrIHNjcmlwdCB3aGVuIDJuZCBhcmcgaXMgcmVtb3ZlZFxuICBsZWF2aW5nIGFzIGlzIGNvbnNpZGVyaW5nLCBkZXNwaXRlIHJldmlld2VyIGluc3RydWN0aW9ucyAqL1xuICBfdG9nZ2xlQnRuU3RhdGUgKGlucHV0TGlzdCwgYnV0dG9uRWwpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdG5DbGFzcyk7XG4gICAgICBidXR0b25FbC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnV0dG9uRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ0bkNsYXNzKTtcbiAgICAgIGJ1dHRvbkVsLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycyAoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbCkpO1xuICAgIHRoaXMuX2J1dHRvbkVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnRuU2VsKTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ0blN0YXRlKHRoaXMuX2lucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWwpO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goIChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnRuU3RhdGUodGhpcy5faW5wdXRMaXN0LCB0aGlzLl9idXR0b25FbCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24gKCkge1xuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goIChpbnB1dCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyKGlucHV0KTtcbiAgICB9KTtcbiAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG5cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IGhhbmRsZVN1Ym1pdCB9LCBwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlU3VibWl0O1xuICAgIHRoaXMuaW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICB9XG5cbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgLy8gQ3JlYXRlIGVtcHR5IG9iamVjdFxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcblxuICAgIC8vIEFkZCB0aGUgdmFsdWVzIG9mIHRoZSBmaWVsZHMgdG8gdGhpcyBvYmplY3RcbiAgICB0aGlzLmlucHV0TGlzdC5mb3JFYWNoKCBpbnB1dCA9PiB7XG4gICAgICB0aGlzLl9mb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG5cbiAgICAvLyBSZXR1cm4gdmFsdWVzIG9iamVjdFxuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdChldnQpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07IiwiY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGRhdGE7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjsiLCJjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBjYXJlZXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2FyZWVyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZWVyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgY2FyZWVyOiB0aGlzLl9jYXJlZXJFbGVtZW50LnRleHRDb250ZW50XG4gICAgfVxuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBjYXJlZXIgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9jYXJlZXJFbGVtZW50LnRleHRDb250ZW50ID0gY2FyZWVyO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvOyIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcbmltcG9ydCB7IGluaXRpYWxDYXJkcyB9IGZyb20gXCIuLi91dGlscy9pbml0aWFsQ2FyZHNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xuXG4vLyBWYXJpYWJsZXNcblxuY29uc3QgZWRpdFByb2ZpbGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xuY29uc3QgYWRkQ2FyZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0blwiKTtcbmNvbnN0IGZvcm1Qcm9maWxlRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtX3R5cGVfcHJvZmlsZVwiKTtcbmNvbnN0IGZvcm1DYXJkRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtX3R5cGVfY2FyZFwiKTtcblxuY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XG4gIGZvcm1TZWw6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnRuU2VsOiBcIi5tb2RhbF9fc2F2ZVwiLFxuICBpbmFjdGl2ZUJ0bkNsYXNzOiBcIm1vZGFsX19zYXZlX2luYWN0aXZlXCIsXG4gIGlucHV0RXJyQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JcIlxufVxuXG5jb25zdCByZW5kZXJDYXJkID0gaXRlbSA9PiB7XG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChpdGVtLCBcIiNjYXJkXCIpLmNyZWF0ZUNhcmQoKTtcbiAgY2FyZENvbnRhaW5lci5hZGRJdGVtKG5ld0NhcmQpO1xufVxuXG4vLyBDcmVhdGUgY2FyZCBjb250YWluZXIgdXNpbmcgU2VjdGlvbiBjbGFzc1xuY29uc3QgY2FyZENvbnRhaW5lciA9IG5ldyBTZWN0aW9uKHtcbiAgZGF0YTogaW5pdGlhbENhcmRzLnJldmVyc2UoKSxcbiAgcmVuZGVyZXI6IHJlbmRlckNhcmRcbiAgfSxcbiAgXCIuY2FyZHNcIlxuKTtcblxuLy8gUmVuZGVyIHRoZSBpbml0aWFsIGNhcmQgbGlzdC5cbmNhcmRDb250YWluZXIucmVuZGVySXRlbXMoKTtcblxuLy8gU2NyaXB0c1xuXG4vLyBDcmVhdGUgcHJvZmlsZSBjbGFzc2VzIGFuZCBpbml0aWFsaXplIGVkaXQgcHJvZmlsZSBmb3JtIHZhbGlkYXRpb24uXG5jb25zdCBwcm9maWxlSW5mbyA9IG5ldyBVc2VySW5mbyh7IG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLCBjYXJlZXJTZWxlY3RvcjogXCIucHJvZmlsZV9fY2FyZWVyXCJ9KTtcblxuY29uc3QgbW9kYWxQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBoYW5kbGVTdWJtaXQ6IGV2dCA9PiB7XG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8obW9kYWxQcm9maWxlLmdldElucHV0VmFsdWVzKCkpO1xuICB9LFxuICBoYW5kbGVPcGVuOiAoKSA9PiB7XG5cbiAgfVxufSwgXCIubW9kYWxfdHlwZV9wcm9maWxlXCIpO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0aW9uQ29uZmlnLCBmb3JtUHJvZmlsZUVsKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuZWRpdFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgeyBuYW1lLCBjYXJlZXIgfSA9IHByb2ZpbGVJbmZvLmdldFVzZXJJbmZvKCk7XG4gIG1vZGFsUHJvZmlsZS5pbnB1dExpc3RbMF0udmFsdWUgPSBuYW1lO1xuICBtb2RhbFByb2ZpbGUuaW5wdXRMaXN0WzFdLnZhbHVlID0gY2FyZWVyO1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgbW9kYWxQcm9maWxlLm9wZW4oKTtcbn0pO1xuXG4vLyBDcmVhdGUgYWRkIGNhcmQgY2xhc3NlcyBhbmQgaW5pdGlhbGl6ZSBhZGQgY2FyZCBmb3JtIHZhbGlkYXRpb24uXG5cbi8vIGNvbnN0IG1vZGFsXG5cbmNvbnN0IG1vZGFsQ2FyZCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgaGFuZGxlU3VibWl0OiBldnQgPT4ge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGNhcmREZXRhaWxzID0gbW9kYWxDYXJkLmdldElucHV0VmFsdWVzKCk7XG4gICAgcmVuZGVyQ2FyZChjYXJkRGV0YWlscyk7XG4gIH1cbn0sXG5cIi5tb2RhbF90eXBlX2NhcmRcIik7XG5cbmV4cG9ydCBjb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZm9ybVZhbGlkYXRpb25Db25maWcsIGZvcm1DYXJkRWwpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmFkZENhcmRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZm9ybUNhcmRFbC5yZXNldCgpO1xuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBtb2RhbENhcmQub3BlbigpO1xufSk7XG5cblxuXG5cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICB9LFxuXTsiXSwibmFtZXMiOlsiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwidGhpcyIsIl9wb3B1cEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfaGFuZGxlRXNjIiwiYmluZCIsIl9oYW5kbGVDbG9zZSIsIm9wZW4iLCJldnQiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJhZGQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJyZW1vdmUiLCJfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhJbWFnZSIsImxpbmsiLCJuYW1lIiwidGV4dENvbnRlbnQiLCJwcmV2aWV3SW1nIiwic3JjIiwiYWx0IiwiQ2FyZCIsImRhdGEiLCJ0ZW1wbGF0ZVNlbCIsIl90ZW1wbGF0ZVNlbCIsIl9uYW1lIiwiX2xpbmsiLCJfaGFuZGxlUHJldmlldyIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJ0b2dnbGUiLCJjbG9zZXN0IiwiX3ByZXZpZXciLCJfY2FyZEVsIiwiX2hhbmRsZUxpa2UiLCJfaGFuZGxlVHJhc2giLCJfY2FyZEltZ0VsIiwiX2dldFRlbXBsYXRlIiwiX2NhcmRUaXRsZUVsIiwiZm9ybVZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsIiwiaW5wdXRTZWwiLCJzdWJtaXRCdG5TZWwiLCJpbmFjdGl2ZUJ0bkNsYXNzIiwiaW5wdXRFcnJDbGFzcyIsImVycm9yQ2xhc3MiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsIiwiX2lucHV0U2VsIiwiX3N1Ym1pdEJ0blNlbCIsIl9pbmFjdGl2ZUJ0bkNsYXNzIiwiX2lucHV0RXJyQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtRWwiLCJpbnB1dEVsIiwiZXJyb3JNc2ciLCJfZXJyb3JFbCIsImlkIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnIiLCJfc2hvd0lucHV0RXJyIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJpbnB1dExpc3QiLCJzb21lIiwiYnV0dG9uRWwiLCJfaGFzSW52YWxpZElucHV0Iiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfYnV0dG9uRWwiLCJfdG9nZ2xlQnRuU3RhdGUiLCJmb3JFYWNoIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInByZXZlbnREZWZhdWx0IiwiaW5wdXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0IiwiX2hhbmRsZVN1Ym1pdCIsIl9mb3JtVmFsdWVzIiwidmFsdWUiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtcyIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIlVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiY2FyZWVyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfY2FyZWVyRWxlbWVudCIsImNhcmVlciIsImVkaXRQcm9maWxlQnRuIiwiYWRkQ2FyZEJ0biIsImZvcm1Qcm9maWxlRWwiLCJmb3JtQ2FyZEVsIiwicmVuZGVyQ2FyZCIsIm5ld0NhcmQiLCJjcmVhdGVDYXJkIiwiY2FyZENvbnRhaW5lciIsImFkZEl0ZW0iLCJyZXZlcnNlIiwicmVuZGVySXRlbXMiLCJwcm9maWxlSW5mbyIsIm1vZGFsUHJvZmlsZSIsInNldFVzZXJJbmZvIiwiZ2V0SW5wdXRWYWx1ZXMiLCJoYW5kbGVPcGVuIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwiZ2V0VXNlckluZm8iLCJyZXNldFZhbGlkYXRpb24iLCJtb2RhbENhcmQiLCJjYXJkRGV0YWlscyIsImFkZEZvcm1WYWxpZGF0b3IiLCJyZXNldCJdLCJzb3VyY2VSb290IjoiIn0=